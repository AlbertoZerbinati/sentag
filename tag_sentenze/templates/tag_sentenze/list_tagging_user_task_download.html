{% extends "tag_sentenze/layout.html" %}

{% block title %}
List of Collections
{% endblock %}

{% block content %}
<h2 class="title">Download completed judgments</h2>
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Doc</th>
            {% for user in users %}
            <th>{{user.username}}</th>
            {% endfor %}
            <th><strong>All Users</strong></th>
        </tr>
    </thead>
    <tbody>
        {% for judgment in judgments %}
        <tr>
            <td>{{judgment.name}}</td>
            {% for user in users %}
            <td> <a class="btn btn-sm btn-info" href="">Download</a></td>
            {% endfor %}
            <td> <a class="btn btn-sm btn-info" href="">Download</a></td>
        </tr>
        {% endfor %}

        <tr>
            <td><strong>All Docs</strong></td>
            {% for user in users %}
            <td> <a class="btn btn-sm btn-info" href="">Download</a></td>
            {% endfor %}
            <td> <a class="btn btn-sm btn-info" href="">Download</a></td>
        </tr>

    </tbody>
</table>
{% endblock %}

{% block script %}
<script>
    function downl(id) {
        $.get("/download/" + id, function (data) {
            // console.log(typeof data); // string
            // console.log(data); // HTML content of the jQuery.ajax page

            let filename = data['name'] + ".xml"
            let outputString = data['xml']

            let element = document.createElement("a");
            element.setAttribute(
                "href",
                "data:text/plain;charset=utf-8," + encodeURIComponent(outputString)
            );
            element.setAttribute("download", filename);

            element.style.display = "none";
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        });
    }
</script>
{% endblock %}